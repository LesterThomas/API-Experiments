"use strict";angular.module("webserverApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch","angularJsonld","ui.bootstrap"]).config(["jsonldContextProvider",function(a){a.add({schema:"http://schema.org/",foaf:"http://xmlns.com/foaf/0.1/",list:"http://www.w3.org/ns/hydra/core#member",name:"schema:name",description:"schema:description",friends:"foaf:knows"})}]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl",controllerAs:"main"}).when("/catalogue",{templateUrl:"views/catalogue.html",controller:"CatalogueCtrl",controllerAs:"catalogue"}).when("/admin",{templateUrl:"views/admin.html",controller:"AdminCtrl",controllerAs:"admin"}).otherwise({redirectTo:"/"})}]),angular.module("webserverApp").controller("MainCtrl",function(){}),angular.module("webserverApp").controller("AboutCtrl",function(){this.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}),angular.module("webserverApp").controller("CatalogueCtrl",["$scope","$http",function(a,b,c){console.log("Started controller"),a.rfsCollection=[],b.get("http://localhost:3002/api/catalogue").success(function(b,c,d,e){b.forEach(function(b){var c={};c.name=b["http://schema.org/name"][0]["@value"],c.description=b["http://schema.org/description"][0]["@value"],c["@id"]=b["@id"],a.rfsCollection.push(c)}),console.log("Catalogue get success",b,c)}).error(function(a,b,c,d){console.log("Catalogue get error",a,b,c,d)})}]),angular.module("webserverApp").controller("AdminCtrl",["$scope","$uibModal","$http",function(a,b,c){a.getIntegrationPoints=function(b){c.get("http://localhost:3002/api/integrationPoint").success(function(c,d,e,f){a.integrationCollection=c,a.integrationCollection.forEach(function(a){a.testPing||(a.testPing="a",a.testJSONLD="a",a.testRFSCatalogue="a")}),b&&a.open("lg",b)}).error(function(a,b,c,d){})},a.getIntegrationPoints(),a.animationsEnabled=!0,a.open=function(c,d){var e=b.open({animation:a.animationsEnabled,templateUrl:"/scripts/directives/modalWindow.html",controller:"ModalInstanceCtrl",size:c,resolve:{integrationPoint:function(){var b=null;return a.integrationCollection.forEach(function(a){a._id==d&&(b=a)}),b}}});e.result.then(function(){console.log("View Modal dismissed at: "+new Date),a.getIntegrationPoints()})},a.add=function(c,d){var e=b.open({animation:a.animationsEnabled,templateUrl:"/scripts/directives/addModal.html",controller:"AddModalInstanceCtrl",size:c,resolve:{}});e.result.then(function(b){console.log("Add Modal dismissed at: "+new Date),a.getIntegrationPoints(b)})}}]),angular.module("webserverApp").directive("compModal",function(){return{restrict:"E",replace:!0,transclude:!0,scope:!0,templateUrl:"/scripts/directives/compModal.html",controller:["$scope","$element","$location",function(a,b,c){a.isActive=function(a){var b=!1;return a===c.path()&&(b=!0),b}}]}}),angular.module("webserverApp").controller("ModalInstanceCtrl",["$scope","$uibModalInstance","$http","$interval","jsonld","integrationPoint",function(a,b,c,d,e,f){a.integrationPoint=f,a.integrationPoint.testPing="grey",a.integrationPoint.testJSONLD="grey",a.integrationPoint.testRFSCatalogue="grey",a.integrationPoint.testPingComment="Preparing test",a.integrationPoint.testJSONLDComment="Preparing test",a.integrationPoint.testRFSCatalogueComment="Preparing test",a.ok=function(){c.put("http://localhost:3002/api/"+a.integrationPoint._id.replace(":","/"),a.integrationPoint).success(function(a,c,d,e){console.log("Database put success",c,a),b.close()}).error(function(a,b,c,d){console.log("Database put error",b,a)}),b.dismiss("ok")},a["delete"]=function(){c["delete"]("http://localhost:3002/api/"+a.integrationPoint._id.replace(":","/")).success(function(a,c,d,e){console.log("Database delete success",c,a),b.close()}).error(function(a,b,c,d){console.log("Database delete error",b,a)})},a.runTest=function(){if("grey"==a.integrationPoint.testPing){a.integrationPoint.testPing="a",a.integrationPoint.testPingComment="Starting test";try{c.get(a.integrationPoint.EntryPoint).then(function(b){console.log("Test 1 success",b),a.integrationPoint.testPingComment="Success",a.integrationPoint.testPing="g"},function(b){console.log("Test 1 error"),console.log(b),a.integrationPoint.testPingComment="Fail: Check debug console for more info",a.integrationPoint.testJSONLDComment="Test stopped",a.integrationPoint.testRFSCatalogueComment="Test stopped",a.integrationPoint.testPing="r"})}catch(b){console.log("Test 1 exception",b),a.integrationPoint.testPingComment="Fail: Exception:"+b,a.integrationPoint.testPing="r"}}if("g"==a.integrationPoint.testPing&&"grey"==a.integrationPoint.testJSONLD){a.integrationPoint.testJSONLDComment="Starting test";try{e.expand(a.integrationPoint.EntryPoint,function(b,c){if(b)console.log("Error",b),a.integrationPoint.testJSONLD="r",a.integrationPoint.testJSONLDComment="Fail: Check debug console for more info. "+b,a.integrationPoint.testRFSCatalogueComment="Test stopped";else{console.log("Test 2 success",c),a.integrationPoint.testJSONLD="g",a.integrationPoint.testJSONLDComment="Success";try{a.integrationPoint.testRFSCatalogueComment="Starting test";var d=c[0]["@type"][0],f=d+"/RFSCatalogue";console.log("Catalogue End Point Type is",f);var g=c[0][f][0]["@id"];console.log("Catalogue End Point is",g),e.expand(g,function(b,c){b?(console.log("Error",b),a.integrationPoint.testRFSCatalogue="r",a.integrationPoint.testRFSCatalogueComment="Fail: Check debug console for more info:"+b):(console.log("Expanded Catalogue",c),a.integrationPoint.testRFSCatalogueComment="Success",a.integrationPoint.testRFSCatalogue="g")})}catch(b){console.log("Test 3 exception",b),a.integrationPoint.testRFSCatalogueComment="Fail: Exception:"+b,a.integrationPoint.testRFSCatalogue="r"}}})}catch(b){console.log("Test 2 exception",b),a.integrationPoint.testJSONLDComment="Fail: Exception:"+b,a.integrationPoint.testJSONLD="r"}}"g"==a.integrationPoint.testJSONLD&&"grey"==a.integrationPoint.testRFSCatalogue&&(a.integrationPoint.testRFSCatalogue="r",a.integrationPoint.testRFSCatalogueComment="Starting test")},d(a.runTest,1e3)}]),angular.module("webserverApp").controller("AddModalInstanceCtrl",["$scope","$uibModalInstance","$http",function(a,b,c){a.integrationPoint={EntryPoint:""},a.ok=function(){b.close()},a.cancel=function(){b.dismiss("cancel")},a.add=function(){c({method:"POST",url:"http://localhost:3002/api/integrationPoint",headers:{"content-type":"application/json"},data:a.integrationPoint}).success(function(a,c,d,e){console.log("Database add success",c,a);var f=a.id.split("/"),g=f[f.length-1];b.close("IntegrationPoint:"+g)}).error(function(a,b,c,d){console.log("Database add error",b,a)})}}]),angular.module("webserverApp").run(["$templateCache",function(a){a.put("views/about.html","<p>This is the about view.</p>"),a.put("views/admin.html",'<h4>Administer integration points</h4> <div ng-if="integrationCollection.length>0"> <p>Click on a row in the table below to run the integration tests or to delete the integration point.</p> <br> <table class="table table-striped table-hover"> <thead> <tr> <th>Id</th> <th>API Entry Point</th> <th><small>HTTP GET </small></th> <th><small>JSON-LD</small></th> <th><small>RFS Catalogue</small></th> </tr> </thead> <tbody> <tr ng-repeat="row in integrationCollection" ng-click="open(\'lg\',\'{{row._id}}\')"> <td>{{row._id}}</td> <td>{{row.EntryPoint}}</td> <td><img src="/images/{{row.testPing}}.bmp"></td> <td><img src="/images/{{row.testJSONLD}}.bmp"></td> <td><img src="/images/{{row.testRFSCatalogue}}.bmp"></td>  </tr> </tbody> </table> <br><br> </div> <br><br> <p>Add integration point</p> <button class="btn btn-primary" type="button" ng-click="add()">Add</button> <br><br><br><br><br>'),a.put("views/catalogue.html",'<p>Resource Facing Service Catalogue</p> <br> <table class="table table-striped"> <thead> <tr> <th>Name</th> <th>Description</th> <th>Id</th> </tr> </thead> <tbody> <tr ng-repeat="row in rfsCollection"> <td>{{row.name}}</td> <td>{{row.description}}</td> <td>{{row[\'@id\']}}</td> </tr> </tbody> </table> <br><br><br><br><br>'),a.put("views/main.html",'<div class="mainHeadder"> <table> <tr> <td> <h2>Next Generation API Experiments</h2> <p class="lead"> <br> Demonstration of next-generation API\'s based on Hyper-media, linked-data (<a href="http://json-ld.org/">JSON-LD</a>), <a href="http://www.hydra-cg.com/">Hydra</a> and the <a href="http://www.w3.org/standards/semanticweb/">semantic web</a>. </p> </td> <td> <img src="/images/api.5bcab590.gif" height="150"> </td> </tr> </table> </div> <div class="row marketing"> <h4>Catalogue</h4> <p> This shows a federated catalogue that is built by integrating with any number of other catalogues. In this example, we model Resource Facing Service (RFS) catalogues. The integration is bound at run-time and new integrations can be added just by apecifying an API <a href="http://schema.org/EntryPoint">Entry Point</a> in the Admin area. </p> <h4>Admin pages</h4> <p> This is where the list of Integration API <a href="http://schema.org/EntryPoint">Entry Point</a>s are maintained. </p> </div>')}]);